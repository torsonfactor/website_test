{% extends 'mainapp/output/output.html' %}
{% load crispy_forms_tags %}

{% block content %}

    <h5 class="text-center mt-5 mb-5">Офорление заказа</h5>
    {% if messages %}
        {% for message in messages %}
            <div class="alert alert-danger fade show" role="alert" style="width: 85%; margin: auto;">
                <strong>{{ message }}</strong>
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
        {% endfor %}
    {% endif %}
    <table class="table text-center" style="width: 85%; margin: auto;">
      <thead>
        <tr>
          <th class="hide_elements" scope="col">Наименование</th>
          <th scope="col">Изображение </th>
          <th scope="col">Цена </th>
          <th scope="col">Кол-во</th>
          <th scope="col">Размер</th>
          <th class="hide_elements" scope="col">Общая цена</th>
        </tr>
      </thead>
      <tbody>
        {% for item in cart.products.all %}
        <tr>
          <th class="hide_elements" scope="row">{{ item.content_object.title }}</th>
          <td class="w-25">
              <a>
                  <img src="{{ item.content_object.photo.url }}" id="image_cart_product" class="img-fluid">
              </a>
              <a id="image_cart_product_mobile" style="color: #232526c9; text-decoration: none;">
                  {{ item.content_object.title }}
              </a>
          </td>
          <td class="changing_width">
              {% if item.content_object.discount %}
                  <strong>
                      {{item.content_object.sale_price}} руб.
                  </strong>
                  <a style="text-decoration: line-through;">
                      {{item.content_object.price}} руб.
                  </a>
              {% else %}
                  {{ item.content_object.price }} руб.
              {% endif %}
          </td>
          <td class="changing_width">{{ item.qty }}</td>
          <td class="changing_width">{{ item.size }}</td>
          <td class="hide_elements">{{ item.final_price }} руб.</td>
        </tr>
        {% endfor %}
        <tr>
            <td class="hide_elements" colspan="2"></td>
            <td style="vertical-align: middle;"><strong>Итого: </strong></td>
            <td style="vertical-align: middle;"><strong>{{cart.total_products }} шт.</strong></td>
            <td style="vertical-align: middle;"><strong>{{cart.final_price }} руб.</strong></td>
        </tr>
      </tbody>
    </table>

    <h3 class="text-center mt-5 mb-5">Форма заказа</h3>
    <form action="{% url 'make-order' %}" method="POST" style="width: 75%; margin: auto;">
        {% csrf_token %}
        {{ form|crispy }}
        <input type="submit" class="btn btn-success btn-block mb-3" value="Оформить заказ">
    </form>


{% endblock content %}